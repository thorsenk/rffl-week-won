<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RFFL Week 1 vs. Median</title>
    <meta name="description" content="The official RFFL Week 1 median scoring webapp - teams compete against the league median instead of head-to-head opponents.">
    <meta name="author" content="RFFL Competition Committee">
    <meta name="creation-date" content="2025-09-05T00:00:00-05:00">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="css/design-tokens.css">
    <link rel="stylesheet" href="css/components.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/design-tokens.css">
    <link rel="stylesheet" href="css/components.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #111827; /* gray-900 */
        }

        /* Week 1 Median Specific Styling */
        .median-indicator {
            background: linear-gradient(90deg, #8b5cf6, #06b6d4);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 700;
            animation: medianPulse 2s ease-in-out infinite;
        }

        @keyframes medianPulse {
            0%, 100% { opacity: 0.8; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.05); }
        }

        .median-line {
            position: relative;
        }

        .median-line::after {
            content: 'MEDIAN';
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            background: #8b5cf6;
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: bold;
        }

        /* Enhanced Key Moments Timeline */
        .timeline { position: relative; padding: 20px 0; }
        .timeline::before { content: ''; position: absolute; left: 50%; top: 0; bottom: 0; width: 2px; background-color: #4b5563; transform: translateX(-50%); }
        .timeline-item { position: relative; width: 50%; padding: 10px 40px; opacity: 0; animation: fadeIn 0.5s ease-out forwards; }
        .timeline-item:nth-child(odd) { left: 0; }
        .timeline-item:nth-child(even) { left: 50%; }
        .timeline-content { padding: 15px; background: #1f2937; border-radius: 8px; position: relative; }
        .timeline-item:nth-child(odd) .timeline-content { text-align: right; }
        .timeline-item::after { content: ''; position: absolute; width: 16px; height: 16px; right: -8px; background-color: white; border: 4px solid #4b5563; top: 50%; transform: translateY(-50%); border-radius: 50%; z-index: 1; }
        .timeline-item:nth-child(even):after { left: -8px; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .standings-row { opacity: 0; animation: fadeIn 0.5s ease-out forwards; }

        /* Enhanced Matchup Box Styling for Median Display */
        .median-matchup-box {
            transition: all 0.3s ease-in-out;
            cursor: pointer;
            background: linear-gradient(135deg, #1f2937 0%, #111827 100%);
            border: 2px solid transparent;
            position: relative;
        }

        .median-matchup-box.active {
            border-color: #8b5cf6;
            box-shadow: 0 0 20px rgba(139, 92, 246, 0.4);
        }

        .median-matchup-box.above-median {
            border-left: 4px solid #10b981; /* green for above median */
        }

        .median-matchup-box.below-median {
            border-left: 4px solid #ef4444; /* red for below median */
        }

        .median-matchup-box.at-median {
            border-left: 4px solid #f59e0b; /* yellow for exactly at median */
        }
        
        @keyframes pulseGlow {
            0%, 100% { box-shadow: 0 0 8px rgba(59, 130, 246, 0.3); }
            50% { box-shadow: 0 0 16px rgba(59, 130, 246, 0.6); }
        }
        .live-game-pulse {
            animation: pulseGlow 3s infinite ease-in-out;
        }
        .badge {
            display: inline-block;
            font-size: 1rem;
            margin-left: 8px;
            animation: fadeIn 0.5s;
        }
        .gemini-button {
            transition: all 0.3s ease;
        }
        .gemini-button:hover {
            box-shadow: 0 0 15px rgba(192, 132, 252, 0.5); /* purple-400 */
        }
        .loader {
            border: 2px solid #f3f3f3;
            border-top: 2px solid #8b5cf6; /* violet-500 */
            border-radius: 50%;
            width: 16px;
            height: 16px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Median comparison indicators */
        .median-status {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            font-size: 12px;
            font-weight: 600;
        }

        .median-status.win { color: #10b981; }
        .median-status.loss { color: #ef4444; }
        .median-status.tie { color: #f59e0b; }
    </style>
</head>
<body class="bg-gray-900 text-gray-200 p-2 sm:p-6 md:p-8">

    <div class="max-w-7xl mx-auto">
        <!-- Week 1 Median Header -->
        <header class="text-center mb-8">
            <h1 class="text-3xl sm:text-5xl font-bold text-white mb-2">
                RFFL Week 1 
                <span class="median-indicator">vs. Median</span>
            </h1>
            <p class="text-gray-400 mb-4">Official source for Week 1 results - teams compete against the league median score</p>
            
            <!-- Current Median Display -->
            <div class="bg-gradient-to-r from-purple-900/50 to-cyan-900/50 rounded-lg p-4 mb-4 border border-purple-500/30">
                <div class="text-center">
                    <p class="text-sm text-gray-300 mb-1">Current League Median</p>
                    <p id="current-median" class="text-4xl font-bold median-indicator">--</p>
                    <p class="text-xs text-gray-400 mt-1">Average of 6th & 7th ranked scores</p>
                </div>
            </div>
        </header>

        <!-- League Teams vs Median Grid -->
        <div class="mb-8">
            <h3 class="text-lg font-semibold mb-4 text-white text-center">All Teams vs. Median</h3>
            <div id="median-teams-grid" class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3">
                <!-- Team vs median boxes will be injected by JavaScript -->
            </div>
        </div>

        <!-- Detailed Team View (when a team is selected) -->
        <div id="detailed-team-view" class="bg-gray-800 p-4 sm:p-6 rounded-lg shadow-lg mb-8" style="display: none;">
            <!-- Team vs Median Details -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <!-- Team Info -->
                <div id="selected-team-info" class="text-center md:text-left">
                    <!-- Filled by JavaScript -->
                </div>
                
                <!-- Median Comparison Chart -->
                <div class="text-center">
                    <canvas id="median-comparison-chart" width="300" height="200"></canvas>
                </div>
            </div>

            <!-- Player Breakdown -->
            <div id="team-player-breakdown" class="mt-6">
                <!-- Filled by JavaScript -->
            </div>
        </div>

        <!-- Gemini AI Recap Section -->
        <div class="mt-8 bg-gray-800 p-4 sm:p-6 rounded-lg shadow-lg">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold text-white">âœ¨ Week 1 Median Recap</h3>
                <button id="generate-recap-btn" class="gemini-button bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-lg flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-stars" viewBox="0 0 16 16"><path d="M7.657 6.247c.11-.33.576-.33.686 0l.645 1.937a2.89 2.89 0 0 0 1.829 1.828l1.936.645c.33.11.33.576 0 .686l-1.937.645a2.89 2.89 0 0 0-1.828 1.829l-.645 1.936a.361.361 0 0 1-.686 0l-.645-1.937a2.89 2.89 0 0 0-1.828-1.828l-1.937-.645a.361.361 0 0 1 0-.686l1.937-.645a2.89 2.89 0 0 0 1.828-1.828zM3.794 1.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387A1.73 1.73 0 0 0 4.593 5.9l-.387 1.162a.217.217 0 0 1-.412 0L3.407 5.9A1.73 1.73 0 0 0 2.31 4.807l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387A1.73 1.73 0 0 0 3.407 2.31zM10.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732L9.1 2.137a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732z"/></svg>
                    Generate Recap
                </button>
            </div>
            <div id="recap-content" class="text-gray-300 text-sm prose">
                Click the button to generate a narrative recap of Week 1 median results!
            </div>
        </div>

        <!-- League Standings Table (vs Median) -->
        <div class="mt-8 bg-gray-800 p-4 sm:p-6 rounded-lg shadow-lg">
            <h3 class="text-lg font-semibold mb-4 text-white text-center">Week 1 Final Standings (vs. Median)</h3>
            <div class="overflow-x-auto">
                <table class="w-full text-sm text-left">
                    <thead class="text-gray-400 uppercase tracking-wider text-xs border-b border-gray-700">
                        <tr>
                            <th class="p-3">#</th>
                            <th class="p-3">Team</th>
                            <th class="p-3 text-right">Score</th>
                            <th class="p-3 text-right">vs. Median</th>
                            <th class="p-3 text-center">Result</th>
                        </tr>
                    </thead>
                    <tbody id="median-standings-body" class="divide-y divide-gray-700"></tbody>
                </table>
            </div>
        </div>

        <!-- Median Analysis Charts -->
        <div class="mt-8 bg-gray-800 p-4 sm:p-6 rounded-lg shadow-lg">
            <h3 class="text-lg font-semibold mb-4 text-white text-center">League Score Distribution</h3>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div>
                    <h4 class="text-center text-gray-300 mb-2">Score Distribution</h4>
                    <canvas id="score-distribution-chart"></canvas>
                </div>
                <div>
                    <h4 class="text-center text-gray-300 mb-2">Median Performance</h4>
                    <canvas id="median-performance-chart"></canvas>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="mt-12 text-center text-gray-500 text-sm">
            <p>RFFL Week 1 Median System - Official Results</p>
            <p class="mt-1">ESPN shows placeholder opponents; this webapp is the authoritative source</p>
            <p class="mt-2">
                <a href="styleguide.html" class="text-purple-400 hover:text-purple-300 underline">Open Style Guide</a>
            </p>
        </footer>
    </div>

    <!-- Include JavaScript modules -->
    <script src="js/median-calculator.js"></script>
    <script src="js/rffl-data.js"></script>
    <script src="js/espn-api.js"></script>
    <script src="js/main.js"></script>

</body>
</html>
